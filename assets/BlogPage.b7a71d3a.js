import{G as _,u as g,a as $,r as e,R as w,b as S,c as L,L as z,d as B}from"./index.a8391bd9.js";import{c as f,a as v,F as C,b as N}from"./formik.esm.ca1d06d9.js";import{f as P}from"./fetchBlog.f16e77d6.js";const F="_blog_1iyr1_1",T="_message_1iyr1_27",I="_error_1iyr1_43",R="_edit_1iyr1_49",A="_buttons_1iyr1_71",H="_icon_1iyr1_81";var d={blog:F,message:T,error:I,edit:R,buttons:A,icon:H};const M="_icon_dftfj_1";var O={icon:M};function y(t){return _({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]})(t)}function j(t){const a=g(s=>s.user.token),m=$(),i=t.id,l=async()=>{try{const s=await fetch(`https://blogmania.onrender.com/user/${i}`,{method:"DELETE",headers:{authorization:`BEARER ${a}`}});if(m(-1),!s.ok)throw new Error("Could not delete blog page")}catch(s){console.log(s)}};return e.exports.createElement(y,{size:"30px",color:"red",className:O.icon,onClick:l})}const D="_error_1p36k_1",V="_form_1p36k_9";var h={error:D,form:V};function q(t){const[a,m]=e.exports.useState(!1),i=g(o=>o.user.token),l=async o=>{try{if(!(await fetch(`https://blogmania.onrender.com/blogs/comment/${t.blogId}`,{method:"POST",body:JSON.stringify({comment:o.comment}),headers:{"Content-Type":"application/json",authorization:`BEARER ${i}`}})).ok)throw new Error("Could not create new comment");t.toggler()}catch(r){console.log(r)}},s=f().shape({comment:v().required("Your comment is empty!")});return e.exports.createElement("section",{className:h.form},e.exports.createElement(C,{initialValues:{comment:""},validationSchema:s,validateOnChange:!1,validateOnBlur:!1,onSubmit:o=>{l(o),m(!0),setTimeout(()=>{m(!1)},3e3)}},({errors:o,handleBlur:r,handleChange:u,values:c})=>e.exports.createElement(N,null,e.exports.createElement("label",{htmlFor:"comment"}," Add a Comment"),e.exports.createElement("textarea",{name:"comment",onChange:u,onBlur:r,value:c.comment}),o.comment&&e.exports.createElement("div",{className:h.error},o.comment),e.exports.createElement("button",{className:"btn",type:"submit",disabled:a},"Comment"))))}const G="_item_jxtt1_1",J="_user_jxtt1_13",U="_span_jxtt1_41",Y="_icon_jxtt1_47";var p={item:G,user:J,span:U,icon:Y},Q="/myblog/assets/user-img.71898c51.png";function k(t){return _({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 21a1 1 0 0 0 .24 0l4-1a1 1 0 0 0 .47-.26L21 7.41a2 2 0 0 0 0-2.82L19.42 3a2 2 0 0 0-2.83 0L4.3 15.29a1.06 1.06 0 0 0-.27.47l-1 4A1 1 0 0 0 3.76 21 1 1 0 0 0 4 21zM18 4.41 19.59 6 18 7.59 16.42 6zM5.91 16.51 15 7.41 16.59 9l-9.1 9.1-2.11.52z"}}]})(t)}function K(t){const[a,m]=e.exports.useState(!1),i=g(o=>o.user.token),l=async o=>{try{if(!(await fetch(`https://blogmania.onrender.com/blogs/comment/${t.commentId}`,{method:"PATCH",body:JSON.stringify({comment:o.comment}),headers:{"Content-Type":"application/json",authorization:`BEARER ${i}`}})).ok)throw new Error("Could not update comment");t.editToggle(),t.toggler()}catch(r){console.log(r)}},s=f().shape({comment:v().required("Your comment is empty!")});return e.exports.createElement("section",{className:h.form},e.exports.createElement(C,{initialValues:{comment:t.comment},validationSchema:s,validateOnChange:!1,validateOnBlur:!1,onSubmit:o=>{l(o),m(!0),setTimeout(()=>{m(!1)},3e3)}},({errors:o,handleBlur:r,handleChange:u,values:c})=>e.exports.createElement(N,null,e.exports.createElement("label",{htmlFor:"comment"}," Edit Comment"),e.exports.createElement("textarea",{name:"comment",onChange:u,onBlur:r,value:c.comment}),o.comment&&e.exports.createElement("div",{className:h.error},o.comment),e.exports.createElement("button",{className:"btn",type:"submit",disabled:a},"Comment"))))}function W(t){const a=g(n=>n.user.token),i=g(n=>n.user.id)===t.comment.user._id,[l,s]=e.exports.useState(!1);function o(n){return n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()}const r=()=>{s(n=>!n)},u=async()=>{try{if(!(await fetch(`https://blogmania.onrender.com/blogs/comment/${t.comment._id}`,{method:"DELETE",headers:{authorization:`BEARER ${a}`}})).ok)throw new Error("Could not delete comment");t.toggler()}catch(n){console.log(n)}},c=new Date(t.comment.date).toLocaleString();return e.exports.createElement("div",{className:p.item},e.exports.createElement("div",{className:p.user},e.exports.createElement("img",{src:Q,alt:"Icon"}),e.exports.createElement("h3",null,o(t.comment.user.firstName)+" "+o(t.comment.user.lastName)+" ",e.exports.createElement("span",{className:p.span},c),e.exports.createElement("span",null,i&&e.exports.createElement(e.exports.Fragment,null,e.exports.createElement(k,{size:"20px",color:"grey",className:p.icon,onClick:r}),e.exports.createElement(y,{size:"20px",color:"grey",className:p.icon,onClick:u}))))),l?e.exports.createElement(K,{commentId:t.comment._id,comment:t.comment.content,toggler:t.toggler,editToggle:r}):e.exports.createElement("p",null,t.comment.content))}const X="_comments_1r48b_1",Z="_btn_1r48b_13",ee="_container_1r48b_15",te="_active_1r48b_59";var x={comments:X,btn:Z,container:ee,active:te};function oe(t){const{comments:a}=t,m=g(n=>n.user.token),[i,l]=e.exports.useState(0),s=5,o=i*s,r=a.length?a.length:1,u=Math.ceil(r/s),c=({selected:n})=>{l(n)};return e.exports.createElement("div",{className:x.comments},e.exports.createElement("h2",null,"Comments"),m?e.exports.createElement(q,{blogId:t.blogId,toggler:t.toggler}):e.exports.createElement("h3",null,"Login to comment"),a&&e.exports.createElement(e.exports.Fragment,null,a.slice(o,o+s).map(n=>e.exports.createElement(W,{comment:n,key:n._id,toggler:t.toggler})),e.exports.createElement(w,{previousLabel:"Previous",nextLabel:"Next",pageCount:u,onPageChange:c,containerClassName:x.container,previousLinkClassName:x.btn,nextLinkClassName:x.btn,activeClassName:x.active})))}const re=()=>{const t=S(),{id:a}=t,m=g(E=>E.user),[i,l]=e.exports.useState(!1),s=()=>{l(E=>!E)},{data:o,error:r,isLoading:u}=L(["blog-data",a],()=>P(a)),c=o?o.blog:null,n=e.exports.createElement("div",{className:d.buttons},e.exports.createElement(z,{to:`/edit/${a}`},e.exports.createElement(k,{className:d.icon,size:"30px"})),e.exports.createElement(j,{id:a}));let b=!1;return!!m.token&&c&&(b=c.author._id===m.id),r?e.exports.createElement("div",{className:d.message},e.exports.createElement("h1",{className:d.error},r.message)):e.exports.createElement(e.exports.Fragment,null,u?e.exports.createElement(B,null):e.exports.createElement(e.exports.Fragment,null,e.exports.createElement("div",{className:d.blog},e.exports.createElement("h1",null,c.title),e.exports.createElement("h2",null,c.author.firstName+" "+c.author.lastName," "),e.exports.createElement("h3",null,c.description),b&&n,e.exports.createElement("p",null,c.article)),e.exports.createElement(oe,{blogId:a,comments:c.comments,toggler:s})))};export{re as default};
